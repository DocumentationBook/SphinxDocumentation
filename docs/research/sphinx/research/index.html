

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  <meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Sphinx Research &mdash; Detailed Sphinx 0.1 documentation</title>
  

  
  
  
  

  
  <script type="text/javascript" src="../../../static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../../../" src="../../../static/documentation_options.js"></script>
        <script data-url_root="../../../" id="documentation_options" src="../../../static/documentation_options.js"></script>
        <script src="../../../static/jquery.js"></script>
        <script src="../../../static/underscore.js"></script>
        <script src="../../../static/_sphinx_javascript_frameworks_compat.js"></script>
        <script src="../../../static/doctools.js"></script>
    
    <script type="text/javascript" src="../../../static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="../../../static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../../static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../../../static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../../../static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../../static/graphviz.css" type="text/css" />
  <link rel="stylesheet" href="../../../static/css/custom.css" type="text/css" />
    <link rel="index" title="Index" href="../../../genindex/" />
    <link rel="search" title="Search" href="../../../search/" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../../../" class="icon icon-home"> Detailed Sphinx
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../../search/" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul>
<li class="toctree-l1"><a class="reference internal" href="../../../tutorial/">Tutorials</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../concepts/">Concepts</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../">Deep Investigation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../publish/">Publishing</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../glossary/">Glossary</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../../">Detailed Sphinx</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../../../">Docs</a> &raquo;</li>
        
      <li>Sphinx Research</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>This draft documentation is under development.</p>
</div>
<section id="sphinx-research">
<span id="concepts-sphinx-research"></span><h1>Sphinx Research<a class="headerlink" href="#sphinx-research" title="Permalink to this heading">¶</a></h1>
<section id="research-environment">
<h2>Research environment<a class="headerlink" href="#research-environment" title="Permalink to this heading">¶</a></h2>
<p>For the research purposes, let us build documentation using the following environment:</p>
<ol class="arabic">
<li><p>Create a separate folder <code class="docutils literal notranslate"><span class="pre">__test/</span></code>. You can add it to the <code class="docutils literal notranslate"><span class="pre">.gitignore</span></code> file to exclude this folder from the Git
track.</p></li>
<li><p>In this folder, create a reST file called <code class="docutils literal notranslate"><span class="pre">index.rst</span></code> containing two sections with headers and plain text.</p></li>
<li><p>In the <code class="docutils literal notranslate"><span class="pre">__test/</span></code> folder, create two subfolders <code class="docutils literal notranslate"><span class="pre">folder1/</span></code> and <code class="docutils literal notranslate"><span class="pre">folder2/</span></code>,
each containing an <code class="docutils literal notranslate"><span class="pre">index.rst</span></code> file.</p></li>
<li><p>In the root file (<code class="docutils literal notranslate"><span class="pre">__test/index.rst</span></code>), add the <code class="docutils literal notranslate"><span class="pre">toctree</span></code> directive and add references to the the other two
index files.</p></li>
<li><p>Copy the <code class="docutils literal notranslate"><span class="pre">Makefile</span></code> file to the <code class="docutils literal notranslate"><span class="pre">__test/</span></code> folder and edit the line that runs the <code class="docutils literal notranslate"><span class="pre">sphinx-build</span></code> script
to make it look as follows:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>%: Makefile
$(SPHINXBUILD) -b $@ &quot;$(SOURCEDIR)&quot; &quot;$(BUILDDIR)&quot; $(SPHINXOPTS) $(O) -a -C -v
</pre></div>
</div>
<p>The project uses the following command line arguments:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">-a</span></code>: run the build process for all files, that is,
update the HTML files whether the source files were updated or not.
Sphinx will use pickled files processed by Docutils.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">-C</span></code>: don’t require the config file.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">-v</span></code>: provide more details than usually. You can use <code class="docutils literal notranslate"><span class="pre">-vv</span></code> or even <code class="docutils literal notranslate"><span class="pre">-vvv</span></code>, but this would clutter your
screen with excessive data.</p></li>
</ul>
</li>
</ol>
</section>
<section id="preliminary-process">
<h2>Preliminary process<a class="headerlink" href="#preliminary-process" title="Permalink to this heading">¶</a></h2>
<p>Let us consider the doc build process from the beginning:</p>
<ol class="arabic">
<li><p>Start the doc build process from the <code class="docutils literal notranslate"><span class="pre">__test/</span></code> folder:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ make dirhtml
</pre></div>
</div>
<p>This means you choose the <code class="docutils literal notranslate"><span class="pre">dirhtml</span></code> Sphinx builder to create your final documentation.</p>
</li>
<li><p>In accordance with <code class="docutils literal notranslate"><span class="pre">Makefile</span></code>, this command invokes:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">./</span><span class="n">sphinx</span><span class="o">-</span><span class="n">build</span> <span class="o">-</span><span class="n">b</span> <span class="n">dirhtml</span> <span class="s2">&quot;.&quot;</span> <span class="s2">&quot;_build&quot;</span>   <span class="o">-</span><span class="n">a</span> <span class="o">-</span><span class="n">C</span> <span class="o">-</span><span class="n">v</span>
</pre></div>
</div>
<p>where:</p>
<ul class="simple">
<li><p>“.” is the documentation source.</p></li>
<li><p>“_build” is the destination folder where the built documentation must be saved in the <code class="docutils literal notranslate"><span class="pre">dirhtml</span></code> subfolder.</p></li>
</ul>
</li>
<li><p>If you look inside the <code class="docutils literal notranslate"><span class="pre">sphinx-build</span></code> python file (find it using <code class="docutils literal notranslate"><span class="pre">which</span> <span class="pre">sphinx-build</span></code>), you will see nothing
special, but calling the <code class="docutils literal notranslate"><span class="pre">sphinx.cmd.build.main</span></code> module.</p></li>
<li><p>This way, you come to the <code class="docutils literal notranslate"><span class="pre">sphinx/cmd/build.py</span></code> module. Its <code class="docutils literal notranslate"><span class="pre">main</span></code> function checks if the <code class="docutils literal notranslate"><span class="pre">-M</span></code> option exists.
If it does, this function calls <code class="docutils literal notranslate"><span class="pre">sphinx.cmd.build.make_main</span></code>, which calls <code class="docutils literal notranslate"><span class="pre">sphinx.cmd.make_mode.run_make_mode</span></code>.</p>
<p>If it you use <code class="docutils literal notranslate"><span class="pre">-b</span></code> instead of <code class="docutils literal notranslate"><span class="pre">-M</span></code>, you will go to <code class="docutils literal notranslate"><span class="pre">sphinx.cmd.build.build_main</span></code>. Let us consider this way.</p>
</li>
<li><p>The <code class="docutils literal notranslate"><span class="pre">sphinx.cmd.build.build_main</span></code> function starts parsing the command line in the following order:</p>
<ul>
<li><p>The <code class="docutils literal notranslate"><span class="pre">sphinx.cmd.build.get_parser</span></code> function creates an <code class="docutils literal notranslate"><span class="pre">argparse.ArgumentParser</span></code> object (not a Sphinx class)
called <code class="docutils literal notranslate"><span class="pre">parser</span></code> with the <code class="docutils literal notranslate"><span class="pre">usage</span></code>, <code class="docutils literal notranslate"><span class="pre">epilog</span></code>, and <code class="docutils literal notranslate"><span class="pre">description</span></code> arguments. Then it adds many other Sphinx
related arguments to this object.</p></li>
<li><p>Creates a validated list of all argument:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">args</span> <span class="o">=</span> <span class="n">parser</span><span class="o">.</span><span class="n">parse_args</span><span class="p">(</span><span class="n">argv</span><span class="p">)</span>
</pre></div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">args</span></code> is an object of the <code class="docutils literal notranslate"><span class="pre">argparse.Namespace</span></code> class with the following content for the considered example
(important for your further analysis of the program):</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Namespace</span><span class="p">(</span><span class="n">sourcedir</span><span class="o">=</span><span class="s1">&#39;.&#39;</span><span class="p">,</span> <span class="n">outputdir</span><span class="o">=</span><span class="s1">&#39;_build&#39;</span><span class="p">,</span> <span class="n">filenames</span><span class="o">=</span><span class="p">[],</span> <span class="n">builder</span><span class="o">=</span><span class="s1">&#39;dirhtml&#39;</span><span class="p">,</span> <span class="n">force_all</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">freshenv</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
          <span class="n">doctreedir</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">jobs</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">confdir</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">noconfig</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">define</span><span class="o">=</span><span class="p">[],</span> <span class="n">htmldefine</span><span class="o">=</span><span class="p">[],</span> <span class="n">tags</span><span class="o">=</span><span class="p">[],</span>
          <span class="n">nitpicky</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">verbosity</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">quiet</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">really_quiet</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;auto&#39;</span><span class="p">,</span> <span class="n">warnfile</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
          <span class="n">warningiserror</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">keep_going</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">traceback</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">pdb</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
<p>It also creates <code class="docutils literal notranslate"><span class="pre">doctreedir='_build/.doctrees'</span></code> to save pickled files.
Pay attention to some of those arguments that affect the process:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">sourcedir</span><span class="o">=</span><span class="s1">&#39;.&#39;</span><span class="p">,</span> <span class="n">outputdir</span><span class="o">=</span><span class="s1">&#39;_build&#39;</span><span class="p">,</span> <span class="n">builder</span><span class="o">=</span><span class="s1">&#39;dirhtml&#39;</span><span class="p">,</span> <span class="n">force_all</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">doctreedir</span><span class="o">=</span><span class="s1">&#39;_build/.doctrees&#39;</span><span class="p">,</span> <span class="n">jobs</span><span class="o">=</span><span class="mi">1</span>
</pre></div>
</div>
</li>
</ul>
</li>
<li><p>The <code class="docutils literal notranslate"><span class="pre">sphinx.cmd.build.build_main</span></code> function creates the main project object <code class="docutils literal notranslate"><span class="pre">app</span></code> using the <code class="docutils literal notranslate"><span class="pre">args</span></code> properties
and starts the object’s build process:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">app</span> <span class="o">=</span> <span class="n">Sphinx</span><span class="p">(</span><span class="n">args</span><span class="o">.</span><span class="n">sourcedir</span><span class="p">,</span> <span class="n">args</span><span class="o">.</span><span class="n">confdir</span><span class="p">,</span> <span class="n">args</span><span class="o">.</span><span class="n">outputdir</span><span class="p">,</span>
             <span class="n">args</span><span class="o">.</span><span class="n">doctreedir</span><span class="p">,</span> <span class="n">args</span><span class="o">.</span><span class="n">builder</span><span class="p">,</span> <span class="n">confoverrides</span><span class="p">,</span> <span class="n">status</span><span class="p">,</span>
             <span class="n">warning</span><span class="p">,</span> <span class="n">args</span><span class="o">.</span><span class="n">freshenv</span><span class="p">,</span> <span class="n">args</span><span class="o">.</span><span class="n">warningiserror</span><span class="p">,</span>
             <span class="n">args</span><span class="o">.</span><span class="n">tags</span><span class="p">,</span> <span class="n">args</span><span class="o">.</span><span class="n">verbosity</span><span class="p">,</span> <span class="n">args</span><span class="o">.</span><span class="n">jobs</span><span class="p">,</span> <span class="n">args</span><span class="o">.</span><span class="n">keep_going</span><span class="p">)</span>
<span class="n">app</span><span class="o">.</span><span class="n">build</span><span class="p">(</span><span class="n">args</span><span class="o">.</span><span class="n">force_all</span><span class="p">,</span> <span class="n">filenames</span><span class="p">)</span>
</pre></div>
</div>
</li>
</ol>
<p>The <code class="docutils literal notranslate"><span class="pre">app</span></code> object created from the <code class="docutils literal notranslate"><span class="pre">Sphinx</span></code> class has many properties and methods used while building the project:</p>
<p class="plantuml">
<img src="../../../images/plantuml-82caf783ea839f4b4a0e633f9d623762650b3c3f.png" alt="&#64;startuml

class sphinx.project.Project {
}
class sphinx.environment.BuildEnvironment {
}
sphinx.project.Project &lt;-[hidden]- sphinx.builders.Builder
sphinx.project.Project &lt;-[hidden]- sphinx.environment.BuildEnvironment

class Sphinx {
   + phase
   + verbosity = verbosity
   + extensions
   + registry
   + srcdir
   + outdir
   + doctreedir
   + project
   + builder
   + env
   ==
   None preload_builder()
   None create_builder()
   None build(force_all: bool = False, filenames: List[str] = None)
   None setup_extension(extname: str)
   None require_sphinx(self, version: str)
   int connect(self, event: str, callback: Callable, priority: int = 500)
   None disconnect(self, listener_id: int)
   list emit(self, event: str, *args: Any,
             allowed_exceptions: Tuple[Type[Exception], ...] = ())
   Any emit_firstresult(self, event: str, *args: Any,
             allowed_exceptions: Tuple[Type[Exception], ...] = ())
   None add_builder(self, builder: Type[&quot;Builder&quot;], override: bool = False)
   None add_config_value(self, name: str, default: Any, rebuild: Union[bool, str],
                         types: Any = ())
   None add_event(self, name: str)
   None set_translator(self, name: str, translator_class: Type[nodes.NodeVisitor],
                       override: bool = False)
   None add_node(self, node: Type[Element], override: bool = False,
                 **kwargs: Tuple[Callable, Optional[Callable]])
   None add_enumerable_node(self, node: Type[Element], figtype: str,
                            title_getter: TitleGetter = None, override: bool = False,
                            **kwargs: Tuple[Callable, Callable])
   None add_directive(self, name: str, cls: Type[Directive], override: bool = False)
   None add_role(self, name: str, role: Any, override: bool = False)
   None add_generic_role(self, name: str, nodeclass: Any, override: bool = False)
   None add_domain(self, domain: Type[Domain], override: bool = False)
   None add_directive_to_domain(self, domain: str, name: str,
                                cls: Type[Directive], override: bool = False)
   None add_role_to_domain(self, domain: str, name: str, role: Union[RoleFunction, XRefRole],
                           override: bool = False)
   None add_index_to_domain(self, domain: str, index: Type[Index], override: bool = False
                            )
   None add_object_type(self, directivename: str, rolename: str, indextemplate: str = '',
                        parse_node: Callable = None, ref_nodeclass: Type[TextElement] = None,
                        objname: str = '', doc_field_types: List = [], override: bool = False
                        )
   None add_crossref_type(self, directivename: str, rolename: str, indextemplate: str = '',
                          ref_nodeclass: Type[TextElement] = None, objname: str = '',
                          override: bool = False)
   None add_transform(self, transform: Type[Transform])
   None add_post_transform(self, transform: Type[Transform])
   None add_js_file(self, filename: str, priority: int = 500,
                    loading_method: Optional[str] = None, **kwargs: Any)
   None add_css_file(self, filename: str, priority: int = 500, **kwargs: Any)
   None add_latex_package(self, packagename: str, options: str = None,
                          after_hyperref: bool = False)
   None add_lexer(self, alias: str, lexer: Type[Lexer])
   None add_autodocumenter(self, cls: Any, override: bool = False)
   None add_autodoc_attrgetter(self, typ: Type, getter: Callable[[Any, str, Any], Any])
   None add_search_language(self, cls: Any)
   None add_source_suffix(self, suffix: str, filetype: str, override: bool = False)
   None add_source_parser(self, parser: Type[Parser], override: bool = False)
   None add_env_collector(self, collector: Type[EnvironmentCollector])
   None add_html_theme(self, name: str, theme_path: str)
   None add_html_math_renderer(self, name: str,
                               inline_renderers: Tuple[Callable, Callable] = None,
                               block_renderers: Tuple[Callable, Callable] = None)
   None add_message_catalog(self, catalog: str, locale_dir: str)
   None set_html_assets_policy(self, policy)
}

Sphinx::project -&gt; sphinx.project.Project
Sphinx::env -&gt; sphinx.environment.BuildEnvironment
Sphinx::builder -&gt; sphinx.builders.Builder
note left of Sphinx::connect
   Connect a *callback* for the *event*
end note

note left of Sphinx::emit
   Emit *event* and pass *arguments*
   to the callback functions.
end note

note left of Sphinx::add_event
   Register an event to emit.
end note

note left of Sphinx::add_node
   Register a Docutils node class.
end note

note left of Sphinx::add_directive
   Register a Docutils directive.
end note

note left of Sphinx::add_role
   Register a Docutils role.
end note

note left of Sphinx::add_transform
   Register a Docutils transform
   to be applied after parsing.
end note

note left of Sphinx::add_post_transform
   Register a Docutils transform
   to be applied before writing.
end note

note left of Sphinx::add_js_file
   Register a JavaScript file
   to include in the HTML output.
end note

note left of Sphinx::add_css_file
   Register a CSS file
   to include in the HTML output.
end note

note left of Sphinx::add_autodocumenter
   Register a new documenter
   for the autodoc extension.
   sphinx.ext.autodoc.Documenter
end note


&#64;enduml

"/>
</p>
<p>Some of the most important properties are formed from the <code class="docutils literal notranslate"><span class="pre">args</span></code> object that you met in the previous steps:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="bp">self</span><span class="o">.</span><span class="n">srcdir</span> <span class="o">=</span> <span class="n">abspath</span><span class="p">(</span><span class="n">srcdir</span><span class="p">)</span>
<span class="bp">self</span><span class="o">.</span><span class="n">outdir</span> <span class="o">=</span> <span class="n">abspath</span><span class="p">(</span><span class="n">outdir</span><span class="p">)</span>
<span class="bp">self</span><span class="o">.</span><span class="n">doctreedir</span> <span class="o">=</span> <span class="n">abspath</span><span class="p">(</span><span class="n">doctreedir</span><span class="p">)</span>
<span class="bp">self</span><span class="o">.</span><span class="n">builder</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">create_builder</span><span class="p">(</span><span class="n">buildername</span><span class="p">)</span>
</pre></div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">self.builder</span></code> is an object of class <code class="docutils literal notranslate"><span class="pre">sphinx.builders.Builder</span></code> that the app will use to build the documentation.
Notice that the <code class="docutils literal notranslate"><span class="pre">buildername</span></code> argument is the <code class="docutils literal notranslate"><span class="pre">args.builder</span></code> (<code class="docutils literal notranslate"><span class="pre">dirhtml</span></code> in this project) property created in a
previous step. This project will create the <code class="docutils literal notranslate"><span class="pre">app.builder</span></code> object from
the <code class="docutils literal notranslate"><span class="pre">DirectoryHTMLBuilder</span></code> class that extends subsequently
the <code class="docutils literal notranslate"><span class="pre">sphinx.builders.html.StandaloneHTMLBuilder</span></code> and <code class="docutils literal notranslate"><span class="pre">sphinx.builders.Builder</span></code> classes:</p>
<p class="plantuml">
<img src="../../../images/plantuml-6913e1b2b858e7ef8070f3078d5815a88c682e8a.png" alt="&#64;startuml
'sphinx.application.Sphinx
sphinx.builders.Builder &lt;|-- sphinx.builders.html.StandaloneHTMLBuilder
sphinx.builders.html.StandaloneHTMLBuilder &lt;|-- sphinx.builders.dirhtml.DirectoryHTMLBuilder

abstract sphinx.builders.Builder {
   str name = ''
   str format = ''
   str epilog = ''
   default_translator_class: Type[nodes.NodeVisitor] = None
   versioning_method = 'none'
   versioning_compare = False
   allow_parallel = False
   use_message_catalog = True
   ==
   __init__(app: &quot;Sphinx&quot;)
   None set_environment(self, env: BuildEnvironment)
   Type[nodes.NodeVisitor] get_translator_class(*args: Any)
   nodes.NodeVisitor create_translator(*args: Any)
   None create_template_bridge()
   str get_relative_uri(from_: str, to: str, typ: str = None)
   None post_process_images(doctree: Node)
   None compile_catalogs(catalogs: Set[CatalogInfo], message: str)
   None compile_all_catalogs()
   None compile_specific_catalogs()
   None compile_update_catalogs()
   None build_all()
   None build_specific(filenames: List[str])
   None build_update()
   None build(docnames: Iterable[str], summary: str = None, method: str = 'update')
   List[str] read()
   None read_doc(docname: str)
   None write_doctree(docname: str, doctree: nodes.document)
   Any get_builder_config(option: str, default: str)
}

note right of sphinx.builders.Builder::read_doc
   Parse a file and add/update inventory entries for the doctree.
end note

note right of sphinx.builders.Builder::write_doctree
   Write the doctree to a file.
end note

class sphinx.builders.html.StandaloneHTMLBuilder {
   str name = 'html'
   str format = 'html'
   str searchindex_filename = 'searchindex.js'

   ==
   None __init__(app: Sphinx)
   None init()
   None prepare_writing(docnames: Set[str])
   sphinx.builders.html.BuildInfo create_build_info()
   Tuple[str, Dict] get_theme_config()
   None init_templates()
   None init_highlighter()
   None init_css_files()
   None add_css_file(filename: str, **kwargs: Any)
   None init_js_files()
   None add_js_file(self, filename: str, **kwargs: Any)
   &#64;property sphinx.writers.html5.HTML5Translator default_translator_class()
   &#64;property str math_renderer_name()
   Iterator[str] get_outdated_docs()
   List[str] get_asset_paths()
   Dict[str, Any] get_doc_context( docname: str, body: str, metatags: str)
   None write_doc(docname: str, doctree: nodes.document)
   None write_doc_serialized(self, docname: str, doctree: nodes.document)
   None finish()
   &#64;progress_message(__('generating indices')) None gen_indices()
   None gen_pages_from_extensions()
   &#64;progress_message(__('writing additional pages')) None gen_additional_pages()
   None write_genindex()
   None write_domain_indices()
   None copy_image_files()
   None copy_download_files()
   None create_pygments_style_file()
   None copy_translation_js()
   None copy_stemmer_js()
   None copy_theme_static_files()
   None copy_html_static_files()
   None copy_html_logo()
   None copy_html_favicon()
   None copy_static_files()
   None copy_extra_files()
   None write_buildinfo()
   None cleanup()
   None post_process_images(doctree: Node)
   None load_indexer(docnames: Iterable[str])
   None index_page(pagename: str, doctree: nodes.document, title: str)
   str get_outfilename(pagename: str)
   None add_sidebars(pagename: str, ctx: Dict)
   str get_target_uri(docname: str, typ: str = None)
   None handle_page(pagename: str, addctx: Dict, templatename: str = 'page.html',
                    outfilename: str = None, event_arg: Any = None)
   None update_page_context(pagename: str, templatename: str,
                            ctx: Dict, event_arg: Any): pass
   None handle_finish()
   &#64;progress_message(__('dumping object inventory')) None dump_inventory()
   None dump_search_index()
}
note right of sphinx.builders.html.StandaloneHTMLBuilder::prepare_writing
   A place where you can add logic before write_doc is run.
end note

note right of sphinx.builders.html.StandaloneHTMLBuilder::__init__
   self.pub = Publisher(
      reader=docutils.readers.doctree.Reader(parser_name='restructuredtext'),
      parser=reader.parser,
      writer=HTMLWriter(self),
      source_class=DocTreeInput,
      destination=StringOutput(encoding='unicode'),
      settings = op.get_default_values(),)
end note

'note right of sphinx.builders.html.StandaloneHTMLBuilder::init
'   Load necessary templates and perform initialization.
'end note

note right of sphinx.builders.html.StandaloneHTMLBuilder::get_doc_context
   Collect items for the template context of a page.
end note

note right of sphinx.builders.html.StandaloneHTMLBuilder::get_asset_paths
   Paths to templates, CSS, and other.
end note

class sphinx.builders.dirhtml.DirectoryHTMLBuilder {
   str name = 'dirhtml'
   ==
   str get_target_uri(docname: str, typ: str = None)
   str get_outfilename(pagename: str)
}

&#64;enduml"/>
</p>
<p>The <code class="docutils literal notranslate"><span class="pre">app</span></code> initialization process sets up the building environment:</p>
<p class="plantuml">
<img src="../../../images/plantuml-6449e802eaba67104463bbfc99f6012db9ccc48a.png" alt="&#64;startuml

class BuildEnvironment {
   + app: Sphinx = None
   + doctreedir: str = None
   + srcdir: str = None
   + config: Config = None
   + config_status: int = None
   + config_status_extra: str = None
   + events: EventManager = None
   + project: Project = None
   + version: Dict[str, str] = None
   + domains = {}
   + settings = default_settings.copy()
   + all_docs: Dict[str, float] = {}
   + dependencies: Dict[str, Set[str]] = defaultdict(set)
   + included: Dict[str, Set[str]] = defaultdict(set)
   + reread_always: Set[str] = set()
   + metadata: Dict[str, Dict[str, Any]] = defaultdict(dict)
   + titles: Dict[str, nodes.title] = {}
   + longtitles: Dict[str, nodes.title] = {}
   + tocs: Dict[str, nodes.bullet_list] = {}
   + toc_num_entries: Dict[str, int] = {}
   + toctree_includes: Dict[str, List[str]] = {}
   + files_to_rebuild: Dict[str, Set[str]] = {}
   + glob_toctrees: Set[str] = set()
   + numbered_toctrees: Set[str] = set()
   ==
   None __init__(app: &quot;Sphinx&quot; = None)
   None clear_doc(docname: str)
   Optional[str] path2doc(self, filename: str)
   str oc2path(docname: str, base: bool = True)
   Tuple[str, str] relfn2path(self, filename: str, docname: str = None)
   None find_files(self, config: Config, builder: &quot;Builder&quot;)
   Tuple[Set[str], Set[str], Set[str]] get_outdated_files(self, config_changed: bool)
   nodes.document get_doctree(self, docname: str)
   nodes.document get_and_resolve_doctree(self, docname: str, builder: &quot;Builder&quot;,
                                doctree: nodes.document = None, prune_toctrees: bool = True,
                                includehidden: bool = False)
   None resolve_references(self, doctree: nodes.document, fromdocname: str,
                           builder: &quot;Builder&quot;)
   None apply_post_transforms(self, doctree: nodes.document, docname: str)
   Dict[str, List[Optional[str]]] collect_relations(self)
   None check_consistency()
}

note top of BuildEnvironment
   The environment in which the ReST files are translated.
    Stores an inventory of cross-file targets and provides doctree
    transformations to resolve links to them.
end note
note left of BuildEnvironment::all_docs
   All read docnames                                    
end note
note left of BuildEnvironment::titles
   TOC inventory
   docname -&gt; title node                              
end note
note left of BuildEnvironment::longtitles
   If only different from title:                         
   docname -&gt; title node
end note
note left of BuildEnvironment::tocs
   nodetree contents:                                    
   docname -&gt; table                                
end note
note left of BuildEnvironment::toc_num_entries
   docname -&gt; number of real entries           
end note
note left of BuildEnvironment::toctree_includes
   docname -&gt; list of toctree includefiles
end note
note left of BuildEnvironment::files_to_rebuild
   Files (containing TOCs) to rebuild:
   docname -&gt; set
end note

note left of BuildEnvironment::dependencies
   names, relative to documentation root:     
   docname -&gt; set of dependent file
end note
note left of BuildEnvironment::included
   docnames included from other documents:
   docname -&gt; set of included file
end note

note left of BuildEnvironment::reread_always
   docnames to re-read unconditionally           
   on next build
end note
note left of BuildEnvironment::metadata
   File metadata:
   docname -&gt; dict of metadata items            
end note
note left of BuildEnvironment::glob_toctrees
   docnames that have :glob: toctrees
end note
note left of BuildEnvironment::numbered_toctrees
   docnames that have :numbered: toctrees
end note
note left of BuildEnvironment::get_doctree
   Read the doctree from the pickle, resolve
   cross-references and toctrees and return it.
end note
note left of BuildEnvironment::get_and_resolve_doctree
   Resolve a *toctree* node into individual
   bullet lists with titles as items
end note

BuildEnvironment::project -&gt; sphinx.project.Project : app.project
BuildEnvironment::app -&gt; sphinx.application.Sphinx : app

&#64;enduml"/>
</p>
</section>
<section id="main-build-process">
<h2>Main build process<a class="headerlink" href="#main-build-process" title="Permalink to this heading">¶</a></h2>
<p>Now you can track the main build process.</p>
<ol class="arabic">
<li><p>The <code class="docutils literal notranslate"><span class="pre">app.build(args.force_all,</span> <span class="pre">filenames)</span></code> method starts processing the project.
The process has the following phases declared in the <code class="docutils literal notranslate"><span class="pre">sphinx.util.build_phase.BuildPhase</span></code> enum class:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">BuildPhase</span><span class="p">(</span><span class="n">IntEnum</span><span class="p">):</span>
   <span class="sd">&quot;&quot;&quot;Build phase of Sphinx application.&quot;&quot;&quot;</span>
   <span class="n">INITIALIZATION</span> <span class="o">=</span> <span class="mi">1</span>
   <span class="n">READING</span> <span class="o">=</span> <span class="mi">2</span>
   <span class="n">CONSISTENCY_CHECK</span> <span class="o">=</span> <span class="mi">3</span>
   <span class="n">RESOLVING</span> <span class="o">=</span> <span class="mi">3</span>
   <span class="n">WRITING</span> <span class="o">=</span> <span class="mi">4</span>
</pre></div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">app.build</span></code> method switches the app from the INITIALIZATION (the phase after the object initialization)
to the READING phase.</p>
</li>
<li><p>As you required to build all files, the <code class="docutils literal notranslate"><span class="pre">app.build</span></code> method goes to the following branch:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="bp">self</span><span class="o">.</span><span class="n">builder</span><span class="o">.</span><span class="n">compile_all_catalogs</span><span class="p">()</span>
<span class="bp">self</span><span class="o">.</span><span class="n">builder</span><span class="o">.</span><span class="n">build_all</span><span class="p">()</span>
</pre></div>
</div>
<p>The first statement goes through a chain of localization calls starting with
<code class="docutils literal notranslate"><span class="pre">sphinx.builders.Builder.compile_all_catalogs</span></code>. As this simple project is based on English, the result of these
calls is the printout similar to this:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">building</span> <span class="p">[</span><span class="n">mo</span><span class="p">]:</span> <span class="nb">all</span> <span class="n">of</span> <span class="mi">0</span> <span class="n">po</span> <span class="n">files</span>
</pre></div>
</div>
<p>The second statement starts the documentation build process using the <code class="docutils literal notranslate"><span class="pre">sphinx.builders.Builder.build_all</span></code> method.
This method calls the <code class="docutils literal notranslate"><span class="pre">sphinx.builders.Builder.build</span></code> method for building all documents:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="bp">self</span><span class="o">.</span><span class="n">build</span><span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="n">summary</span><span class="o">=</span><span class="n">__</span><span class="p">(</span><span class="s1">&#39;all source files&#39;</span><span class="p">),</span> <span class="n">method</span><span class="o">=</span><span class="s1">&#39;all&#39;</span><span class="p">)</span>
</pre></div>
</div>
</li>
<li><p>The <code class="docutils literal notranslate"><span class="pre">sphinx.builders.Builder.build</span></code> method does the following:</p>
<ul>
<li><p>Print out the message “building [dirhtml]: all source files”</p></li>
<li><p>Read the documents this way:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">with</span> <span class="n">logging</span><span class="o">.</span><span class="n">pending_warnings</span><span class="p">():</span>
   <span class="n">updated_docnames</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">read</span><span class="p">())</span>
</pre></div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">sphinx.builders.Builder.read</span></code> method reads all source files. It prints out the message starting with:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">updating</span> <span class="n">environment</span><span class="p">:</span>
</pre></div>
</div>
</li>
<li><p>Get the added, changed, and removed files. If you run the process without changing reST files, you will
see the message:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="mi">0</span> <span class="n">added</span><span class="p">,</span> <span class="mi">0</span> <span class="n">changed</span><span class="p">,</span> <span class="mi">0</span> <span class="n">removed</span>
</pre></div>
</div>
<p>Otherwise, You will see the other numbers.</p>
</li>
<li><p>Calls the <code class="docutils literal notranslate"><span class="pre">sphinx.builders.Builder.write</span></code> method with a list of documents:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="bp">self</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">docnames</span><span class="p">,</span> <span class="nb">list</span><span class="p">(</span><span class="n">updated_docnames</span><span class="p">),</span> <span class="n">method</span><span class="p">)</span>
</pre></div>
</div>
</li>
</ul>
</li>
</ol>
<p>At this point, it makes sense to split the process in two branches, one without added, updated, and removed files
and the other with at least one updated file.</p>
<section id="using-pickled-files">
<h3>Using pickled files<a class="headerlink" href="#using-pickled-files" title="Permalink to this heading">¶</a></h3>
<p>Let us consider a process that requires building documents even though they are not updated.</p>
<ol class="arabic">
<li><p>The <code class="docutils literal notranslate"><span class="pre">sphinx.builders.Builder.write(build_docnames,</span> <span class="pre">updated_docnames,</span> <span class="pre">method)</span></code> method performs
the following operations:</p>
<ul>
<li><p>Define the files to be processed. In this project, the method finds out the all files must be processed using this
conditional block:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">if</span> <span class="n">build_docnames</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">or</span> <span class="n">build_docnames</span> <span class="o">==</span> <span class="p">[</span><span class="s1">&#39;__all__&#39;</span><span class="p">]:</span>
   <span class="c1"># build_all</span>
   <span class="n">build_docnames</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">env</span><span class="o">.</span><span class="n">found_docs</span>
</pre></div>
</div>
<p>In this project, the <code class="docutils literal notranslate"><span class="pre">build_docnames</span></code> variable is equal to <code class="docutils literal notranslate"><span class="pre">{'index'}</span></code>, which corresponds to the root source
file <code class="docutils literal notranslate"><span class="pre">index.rst</span></code>. If you create two folders <code class="docutils literal notranslate"><span class="pre">folder1</span></code> and <code class="docutils literal notranslate"><span class="pre">folder2</span></code> with index files, this value will be
<code class="docutils literal notranslate"><span class="pre">{'index',</span> <span class="pre">'folder1/index',</span> <span class="pre">'folder2/index'}</span></code>.</p>
</li>
<li><p>Start the <code class="docutils literal notranslate"><span class="pre">sphinx.builders.Builder._write_serial(sorted(docnames))</span></code> method to process the source documents.</p></li>
</ul>
</li>
<li><p>The <code class="docutils literal notranslate"><span class="pre">sphinx.builders.Builder._write_serial(sorted(docnames))</span></code> method goes through the following phases for every
document (<code class="docutils literal notranslate"><span class="pre">docname</span></code>) in the <code class="docutils literal notranslate"><span class="pre">docnames</span></code> list:</p>
<ul>
<li><p>Starts the <code class="docutils literal notranslate"><span class="pre">BuildPhase.RESOLVING</span></code> phase, where it resolves the doctree:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">doctree</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">env</span><span class="o">.</span><span class="n">get_and_resolve_doctree</span><span class="p">(</span><span class="n">docname</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span>
</pre></div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">doctree</span></code> for each of the three files of the project looks as follows (the real path is replaces with
placeholder <code class="docutils literal notranslate"><span class="pre">abs_path</span></code>; the output is formatted manually for better readability):</p>
<ul>
<li><p>folder1/index:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">&lt;</span><span class="n">document</span> <span class="n">source</span><span class="o">=</span><span class="s2">&quot;/abs_path/__test/folder1/index.rst&quot;</span><span class="o">&gt;</span>
   <span class="o">&lt;</span><span class="n">section</span> <span class="n">ids</span><span class="o">=</span><span class="s2">&quot;folder-1-index-file&quot;</span> <span class="n">names</span><span class="o">=</span><span class="s2">&quot;folder\ 1\ index\ file&quot;</span><span class="o">&gt;</span>
      <span class="o">&lt;</span><span class="n">title</span><span class="o">&gt;</span><span class="n">Folder</span> <span class="mi">1</span> <span class="n">Index</span> <span class="n">File</span><span class="o">&lt;/</span><span class="n">title</span><span class="o">&gt;</span>
      <span class="o">&lt;</span><span class="n">paragraph</span><span class="o">&gt;</span><span class="n">File</span> <span class="n">content</span> <span class="n">of</span> <span class="n">the</span> <span class="n">Folder</span> <span class="mi">1</span> <span class="n">index</span> <span class="ow">is</span> <span class="n">here</span><span class="o">.&lt;/</span><span class="n">paragraph</span><span class="o">&gt;</span>
   <span class="o">&lt;/</span><span class="n">section</span><span class="o">&gt;</span>
<span class="o">&lt;/</span><span class="n">document</span><span class="o">&gt;</span>
</pre></div>
</div>
</li>
<li><p>folder2/index:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">&lt;</span><span class="n">document</span> <span class="n">source</span><span class="o">=</span><span class="s2">&quot;/abs_path/__test/folder2/index.rst&quot;</span><span class="o">&gt;</span>
   <span class="o">&lt;</span><span class="n">section</span> <span class="n">ids</span><span class="o">=</span><span class="s2">&quot;folder-2-index-file&quot;</span> <span class="n">names</span><span class="o">=</span><span class="s2">&quot;folder\ 2\ index\ file&quot;</span><span class="o">&gt;</span>
      <span class="o">&lt;</span><span class="n">title</span><span class="o">&gt;</span><span class="n">Folder</span> <span class="mi">2</span> <span class="n">Index</span> <span class="n">File</span><span class="o">&lt;/</span><span class="n">title</span><span class="o">&gt;</span>
      <span class="o">&lt;</span><span class="n">paragraph</span><span class="o">&gt;</span><span class="n">File</span> <span class="n">content</span> <span class="n">of</span> <span class="n">the</span> <span class="n">Folder</span> <span class="mi">2</span> <span class="n">index</span> <span class="ow">is</span> <span class="n">here</span><span class="o">.&lt;/</span><span class="n">paragraph</span><span class="o">&gt;</span>
   <span class="o">&lt;/</span><span class="n">section</span><span class="o">&gt;</span>
<span class="o">&lt;/</span><span class="n">document</span><span class="o">&gt;</span>
</pre></div>
</div>
</li>
<li><p>index:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">&lt;</span><span class="n">document</span> <span class="n">source</span><span class="o">=</span><span class="s2">&quot;/abs_path/__test/index.rst&quot;</span><span class="o">&gt;</span>
   <span class="o">&lt;</span><span class="n">section</span> <span class="n">ids</span><span class="o">=</span><span class="s2">&quot;using-documentation-generator&quot;</span> <span class="n">names</span><span class="o">=</span><span class="s2">&quot;using\ documentation\ generator&quot;</span><span class="o">&gt;</span>
      <span class="o">&lt;</span><span class="n">title</span><span class="o">&gt;</span><span class="n">Using</span> <span class="n">documentation</span> <span class="n">generator</span><span class="o">&lt;/</span><span class="n">title</span><span class="o">&gt;</span>
      <span class="o">&lt;</span><span class="n">compound</span> <span class="n">classes</span><span class="o">=</span><span class="s2">&quot;[&#39;toctree-wrapper&#39;]&quot;</span><span class="o">/&gt;</span>
      <span class="o">&lt;</span><span class="n">paragraph</span><span class="o">&gt;</span><span class="n">There</span> <span class="n">are</span> <span class="n">two</span> <span class="n">software</span> <span class="n">products</span> <span class="o">...</span><span class="n">cut</span> <span class="k">for</span> <span class="n">brevity</span><span class="o">...</span> <span class="n">to</span> <span class="n">distinguish</span> <span class="n">it</span><span class="o">.&lt;/</span><span class="n">paragraph</span><span class="o">&gt;</span>
      <span class="o">&lt;</span><span class="n">section</span> <span class="n">ids</span><span class="o">=</span><span class="s2">&quot;introduction&quot;</span> <span class="n">names</span><span class="o">=</span><span class="s2">&quot;introduction&quot;</span><span class="o">&gt;</span>
         <span class="o">&lt;</span><span class="n">title</span><span class="o">&gt;</span><span class="n">Introduction</span><span class="o">&lt;/</span><span class="n">title</span><span class="o">&gt;</span>
            <span class="o">&lt;</span><span class="n">paragraph</span><span class="o">&gt;</span><span class="n">Sphinx</span> <span class="ow">is</span> <span class="n">a</span> <span class="n">powerful</span> <span class="o">...</span><span class="n">cut</span> <span class="k">for</span> <span class="n">brevity</span><span class="o">...</span> <span class="n">this</span> <span class="n">documentation</span><span class="o">.&lt;/</span><span class="n">paragraph</span><span class="o">&gt;</span>
            <span class="o">&lt;</span><span class="n">paragraph</span><span class="o">&gt;</span><span class="n">The</span> <span class="n">examples</span> <span class="n">are</span> <span class="o">...</span><span class="n">cut</span> <span class="k">for</span> <span class="n">brevity</span><span class="o">...</span> <span class="n">the</span> <span class="n">proper</span> <span class="n">changes</span><span class="o">.&lt;/</span><span class="n">paragraph</span><span class="o">&gt;</span>
      <span class="o">&lt;/</span><span class="n">section</span><span class="o">&gt;</span>
      <span class="o">&lt;</span><span class="n">section</span> <span class="n">ids</span><span class="o">=</span><span class="s2">&quot;additional-resources&quot;</span> <span class="n">names</span><span class="o">=</span><span class="s2">&quot;additional\ resources&quot;</span><span class="o">&gt;</span>
         <span class="o">&lt;</span><span class="n">title</span><span class="o">&gt;</span><span class="n">Additional</span> <span class="n">resources</span><span class="o">&lt;/</span><span class="n">title</span><span class="o">&gt;</span>
         <span class="o">&lt;</span><span class="n">paragraph</span><span class="o">&gt;</span><span class="n">This</span> <span class="n">book</span> <span class="n">does</span> <span class="ow">not</span> <span class="n">cover</span> <span class="o">...</span><span class="n">cut</span> <span class="k">for</span> <span class="n">brevity</span><span class="o">...</span> <span class="n">resources</span><span class="p">,</span> <span class="k">for</span> <span class="n">example</span><span class="p">:</span><span class="o">&lt;/</span><span class="n">paragraph</span><span class="o">&gt;</span>
      <span class="o">&lt;/</span><span class="n">section</span><span class="o">&gt;</span>
   <span class="o">&lt;/</span><span class="n">section</span><span class="o">&gt;</span>
<span class="o">&lt;/</span><span class="n">document</span><span class="o">&gt;</span>
</pre></div>
</div>
</li>
</ul>
<p>Note that the root index file contains the <code class="docutils literal notranslate"><span class="pre">toc</span></code> directive represented with
the <code class="docutils literal notranslate"><span class="pre">&lt;compound</span> <span class="pre">classes=&quot;['toctree-wrapper']&quot;/&gt;</span></code> node.</p>
</li>
<li><p>Changes the <code class="docutils literal notranslate"><span class="pre">app</span></code> phase to <code class="docutils literal notranslate"><span class="pre">BuildPhase.WRITING</span></code>, where it starts the write process:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="bp">self</span><span class="o">.</span><span class="n">write_doc_serialized</span><span class="p">(</span><span class="n">docname</span><span class="p">,</span> <span class="n">doctree</span><span class="p">)</span>  <span class="c1"># For parallel processing, not used in the current project</span>
<span class="bp">self</span><span class="o">.</span><span class="n">write_doc</span><span class="p">(</span><span class="n">docname</span><span class="p">,</span> <span class="n">doctree</span><span class="p">)</span>
</pre></div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">write_doc</span></code> method is overwritten in the child class, so it actually is
<code class="docutils literal notranslate"><span class="pre">sphinx.builders.html.StandaloneHTMLBuilder.write_doc(docname,</span> <span class="pre">doctree)</span></code>.</p>
</li>
</ul>
</li>
</ol>
</section>
<section id="building-updated-files">
<h3>Building updated files<a class="headerlink" href="#building-updated-files" title="Permalink to this heading">¶</a></h3>
<p>The most often used case is when at least one file is updated, the Sphinx initiated the full process with the updated
files. For this process do the following minimal changes:</p>
<ol class="arabic simple">
<li><p>In <code class="docutils literal notranslate"><span class="pre">Makefile</span></code>, remove the <code class="docutils literal notranslate"><span class="pre">-a</span></code> and <code class="docutils literal notranslate"><span class="pre">-v</span></code> arguments in the <code class="docutils literal notranslate"><span class="pre">sphinx-build</span></code> command.</p></li>
<li><p>Update a file using the <code class="docutils literal notranslate"><span class="pre">touch</span></code> command that changes only the file access time.</p></li>
</ol>
<p>Accordingly you can start the process as follows:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ touch folder1/index.rst; make dirhtml
</pre></div>
</div>
<p>To trace the process in a viewer, run the process at least one time with the tracer, as in this example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ touch folder1/index.rst; viztracer --ignore_c_function sphinx-build -b dirhtml &quot;.&quot; &quot;_build&quot; -C
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>You cannot use <code class="docutils literal notranslate"><span class="pre">viztracer</span> <span class="pre">make</span> <span class="pre">dirhtml</span></code>, because <code class="docutils literal notranslate"><span class="pre">viztracer</span></code> requires a python module called first,
whereas <code class="docutils literal notranslate"><span class="pre">make</span></code> is a binary executable file.</p>
</div>
<p>Using the <code class="docutils literal notranslate"><span class="pre">result.json</span></code> file, you can track the calls of Sphinx and Docutils functions and methods:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ vizviewer result.json
</pre></div>
</div>
</section>
</section>
</section>


           </div>
           
          </div>
          <footer>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2023, Albert Bagdasarian

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>